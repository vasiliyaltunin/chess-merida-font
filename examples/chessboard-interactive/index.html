<!DOCTYPE html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Chess Merida font demo</title>



    <script src="../../libs/jquery/jquery.min.js" type="text/javascript"></script>

    <link rel="stylesheet" href="../../css/chessmerida-webfont.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />

    <script>

        $(document).ready(function () {
            $('.toDrag').on("dragstart", function (event) {
                var dt = event.originalEvent.dataTransfer;
                dt.setData('Text', $(this).attr('id'));
            });
            $('table td.dragDest').on("dragenter dragover drop", function (event) {
                event.preventDefault();
                if (event.type === 'drop') {
                    var data = event.originalEvent.dataTransfer.getData('Text', $(this).attr('id'));


                    console.log($(this).children().children());

                    var srcClass = $('#' + data + ' i').attr("class");
                    var dstClass = $(this).children().children().attr("class");

                    var srcColor = 0; //1 - white, 2 - black, 0 - empty
                    var dstColor = 0; //1 - white, 2 - black, 0 - empty

                    //we check src item color
                    if (srcClass.indexOf("cm-w") > 0)
                    {
                        srcColor = 1;
                    }
                    if (srcClass.indexOf("cm-b") > 0)
                    {
                        srcColor = 2;
                    }

                    //we get prev parent
                    prevParent = $(this);
                    //and dest parent
                    destParent = $('#' + data).parent();

                    //now we get prev val and detach it from parent
                    prevVal = $(this).children().detach();
                    //and dest val and detach it from parent
                    destVal = $('#' + data).detach();

                    if (dstClass !== undefined)
                    {
                        //we check dst item color if any
                        if (dstClass.indexOf("cm-w") > 0)
                        {
                            dstColor = 1;
                        }
                        if (dstClass.indexOf("cm-b") > 0)
                        {
                            dstColor = 2;
                        }

                        if (srcColor === dstColor) //if same colors
                        {
                            //we just swap values
                            destVal.appendTo(prevParent);
                            prevVal.appendTo(destParent);
                        } else
                        {
                            //if not
                            destVal.appendTo(prevParent);
                            
                            if (srcColor===1)
                            {
                                prevVal.appendTo(".sideW");
                            }
//
                            if (srcColor===2)
                            {
                                prevVal.appendTo(".sideB");
                            }
//
                        }
                    } else
                    {
                            destVal.appendTo(prevParent);
                            prevVal.appendTo(destParent);
//                        console.log(srcColor + " | " + dstColor);
//
//                        console.log(srcClass.indexOf("cm-w"));
//
//                        de = $('#' + data).detach();
//                        de.appendTo($(this));

                    }

                }
                ;
            });
        })
    </script>

</head>
<body>


    <h1>Interactive Chess Board Demo</h1>

    Use cursor to drag pieces around. You also can drag them into/from side table! If pieces color differs then one of it moves to side table.<p>

    <table class="cnt_table">
        <tbody>
            <tr><td>

                    <table class="chessTable">
                        <tbody>
                            <tr>
                                <td class="outer"></td>
                                <td class="outer">A</td>
                                <td class="outer">B</td>
                                <td class="outer">C</td>
                                <td class="outer">D</td>
                                <td class="outer">E</td>
                                <td class="outer">F</td>
                                <td class="outer">G</td>
                                <td class="outer">H</td>
                                <td class="outer"></td>
                            </tr>

                            <tr>
                                <td class="outer">1</td>
                                <td class="dragDest"><div id="a1" class="toDrag" draggable="true"><i class="cm cm-w-rook" aria-hidden="true"></i></div></td>                
                                <td class="dragDest"><div id="b1"  class="toDrag" draggable="true"><i class="cm cm-w-knight" aria-hidden="true"></i></td>                
                                <td class="dragDest"><div id="c1"  class="toDrag" draggable="true"><i class="cm cm-w-bishop" aria-hidden="true"></i></td>                
                                <td class="dragDest"><div id="d1"  class="toDrag" draggable="true"><i class="cm cm-w-queen" aria-hidden="true"></i></td>                
                                <td class="dragDest"><div id="e1"  class="toDrag" draggable="true"><i class="cm cm-w-king" aria-hidden="true"></i></td>                
                                <td class="dragDest"><div id="f1"  class="toDrag" draggable="true"><i class="cm cm-w-bishop" aria-hidden="true"></i></td>                
                                <td class="dragDest"><div id="g1"  class="toDrag" draggable="true"><i class="cm cm-w-knight" aria-hidden="true"></i></td>                
                                <td class="dragDest"><div id="h1"  class="toDrag" draggable="true"><i class="cm cm-w-rook" aria-hidden="true"></i></td>                
                                <td class="cm-rotate-180 outer">8</td>
                            </tr>

                            <tr>
                                <td class="outer">2</td>
                                <td class="dragDest"><div id="a2" class="toDrag" draggable="true"><i class="cm cm-w-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="b2" class="toDrag" draggable="true"><i class="cm cm-w-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="c2" class="toDrag" draggable="true"><i class="cm cm-w-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="d2" class="toDrag" draggable="true"><i class="cm cm-w-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="e2" class="toDrag" draggable="true"><i class="cm cm-w-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="f2" class="toDrag" draggable="true"><i class="cm cm-w-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="g2" class="toDrag" draggable="true"><i class="cm cm-w-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="h2" class="toDrag" draggable="true"><i class="cm cm-w-pawn" aria-hidden="true"></i></div></td>
                                <td class="cm-rotate-180 outer">7</td>
                            </tr>

                            <tr>
                                <td class="outer">3</td>
                                <td class="dragDest"><div id="a3" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="b3" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="c3" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="d3" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="e3" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="f3" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="g3" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="h3" class="toDrag" draggable="true"></div></td>                
                                <td class="cm-rotate-180 outer">6</td>
                            </tr>
                            <tr>
                                <td class="outer">4</td>
                                <td class="dragDest"><div id="a4" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="b4" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="c4" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="d4" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="e4" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="f4" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="g4" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="h4" class="toDrag" draggable="true"></div></td>                
                                <td class="cm-rotate-180 outer">5</td>
                            </tr>
                            <tr>
                                <td class="outer">5</td>
                                <td class="dragDest"><div id="a5" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="b5" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="c5" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="d5" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="e5" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="f5" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="g5" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="h5" class="toDrag" draggable="true"></div></td>                
                                <td class="cm-rotate-180 outer">4</td>
                            </tr>
                            <tr>
                                <td class="outer">6</td>
                                <td class="dragDest"><div id="a6" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="b6" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="c6" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="d6" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="e6" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="f6" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="g6" class="toDrag" draggable="true"></div></td>                
                                <td class="dragDest"><div id="h6" class="toDrag" draggable="true"></div></td>                
                                <td class="cm-rotate-180 outer">4</td>
                            </tr>

                            <tr>
                                <td class="outer">7</td>
                                <td class="dragDest"><div id="a7" class="toDrag" draggable="true"><i class="cm cm-b-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="b7" class="toDrag" draggable="true"><i class="cm cm-b-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="c7" class="toDrag" draggable="true"><i class="cm cm-b-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="d7" class="toDrag" draggable="true"><i class="cm cm-b-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="e7" class="toDrag" draggable="true"><i class="cm cm-b-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="f7" class="toDrag" draggable="true"><i class="cm cm-b-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="g7" class="toDrag" draggable="true"><i class="cm cm-b-pawn" aria-hidden="true"></i></div></td>
                                <td class="dragDest"><div id="h7" class="toDrag" draggable="true"><i class="cm cm-b-pawn" aria-hidden="true"></i></div></td>
                                <td class="cm-rotate-180 outer">2</td>
                            </tr>

                            <tr>
                                <td class="outer">8</td>
                                <td class="dragDest"><div id="a8" class="toDrag" draggable="true"><i class="cm cm-b-rook" aria-hidden="true"></i></div></td>                
                                <td class="dragDest"><div id="b8"  class="toDrag" draggable="true"><i class="cm cm-b-knight" aria-hidden="true"></i></td>                
                                <td class="dragDest"><div id="c8"  class="toDrag" draggable="true"><i class="cm cm-b-bishop" aria-hidden="true"></i></td>                
                                <td class="dragDest"><div id="d8"  class="toDrag" draggable="true"><i class="cm cm-b-queen" aria-hidden="true"></i></td>                
                                <td class="dragDest"><div id="e8"  class="toDrag" draggable="true"><i class="cm cm-b-king" aria-hidden="true"></i></td>                
                                <td class="dragDest"><div id="f8"  class="toDrag" draggable="true"><i class="cm cm-b-bishop" aria-hidden="true"></i></td>                
                                <td class="dragDest"><div id="g8"  class="toDrag" draggable="true"><i class="cm cm-b-knight" aria-hidden="true"></i></td>                
                                <td class="dragDest"><div id="h8"  class="toDrag" draggable="true"><i class="cm cm-b-rook" aria-hidden="true"></i></td>                
                                <td class="cm-rotate-180 outer">1</td>
                            </tr>            
                            <tr>
                                <td class="outer"></td>
                                <td class="outer">A</td>
                                <td class="outer">B</td>
                                <td class="outer">C</td>
                                <td class="outer">D</td>
                                <td class="outer">E</td>
                                <td class="outer">F</td>
                                <td class="outer">G</td>
                                <td class="outer">H</td>
                                <td class="outer"></td>
                            </tr>

                        </tbody>    
                    </table>    

                </td><td class="sideCnt">

                    <table class="sidetable">
                        <tbody>
                            <tr>
                                <th>White</th><th>Black</th>
                            </tr>
                            <tr class="figuresCnt">
                                <td class="dragDest sideW"><div id="white" class="toDrag" draggable="true"></div></td><td class="dragDest sideB"><div id="black" class="toDrag" draggable="true"></div></td>
                            </tr>
                    </table>    



                </td>
            </tr>

        </tbody>    
    </table>    

</body>
</html>
